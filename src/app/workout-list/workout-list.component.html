<div class="container mx-auto p-6">
  <div class="flex justify-between items-center mb-4">
    <input type="text" [(ngModel)]="searchTerm" (keyup)="searchUsers()" placeholder="Search by name"
      class="border border-gray-300 rounded px-2 py-1 text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 w-1/3">

    <select [(ngModel)]="filterType" (change)="filterWorkouts()" class="border border-gray-300 rounded px-2 py-1 text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 w-1/4">
      <option *ngFor="let type of workoutTypes" [value]="type">{{ type }}</option>
    </select>
  </div>

  <table class="w-full border-collapse border border-gray-300 shadow-md">
    <thead>
      <tr class="bg-gray-50 text-left">
        <th class="px-4 py-2 font-medium text-gray-700">Name</th>
        <th class="px-4 py-2 font-medium text-gray-700">Workouts</th>
        <th class="px-4 py-2 font-medium text-gray-700">Count</th>
        <th class="px-4 py-2 font-medium text-gray-700">Minutes</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of paginatedUsers" (click)="selectUser(user)" class="hover:bg-gray-50 cursor-pointer">
        <td class="px-4 py-2 text-gray-700">{{ user.name }}</td>
        <td class="px-4 py-2 text-gray-700">
          <span *ngFor="let workout of user.workouts; let last = last">
            {{ workout.type }} ({{ workout.minutes }} min)
            <span *ngIf="!last">, </span>
          </span>
        </td>
        <td class="px-4 py-2 text-center text-gray-700">{{ user.workouts.length }}</td>
        <td class="px-4 py-2 text-center text-gray-700">{{ calculateTotalMinutes(user) }}</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="filteredUsers.length > itemsPerPage" class="mt-4 flex justify-center">
    <button [disabled]="currentPage === 1" (click)="changePage(currentPage - 1)" class="bg-gray-200 text-gray-800 py-2 px-4 rounded mr-2">Previous</button>
    <span *ngFor="let page of getPages()">
      <button [class.active]="page === currentPage" (click)="changePage(page)" class="bg-gray-200 text-gray-800 py-2 px-4 rounded mx-1">{{ page }}</button>
    </span>
    <button [disabled]="isNextPageDisabled()" (click)="changePage(currentPage + 1)" class="bg-gray-200 text-gray-800 py-2 px-4 rounded ml-2">Next</button>
  </div>

  <app-workout-comparison [user]="selectedUser" *ngIf="selectedUser"></app-workout-comparison>
</div>
